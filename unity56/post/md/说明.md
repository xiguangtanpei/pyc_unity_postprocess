### 说明

* 一般来说理解是基于下面这张图 

![img](img/20181225173228495.png)


 

主要是对于高亮部分进行模糊操作  

   
下面来学习关于unity 中的描述     
![](img/guan.jpg) 
![img](img/kai.jpg)  
具体操作界面  
![img](img/Snipaste_2020-04-22_15-27-09.jpg)  
可以看到 在shade 开始是传入3个纹理  
``` code
        _MainTex ("", 2D) = "" {}
        _BaseTex ("", 2D) = "" {}
        _AutoExposure ("", 2D) = "" {}
```
用到了一个函数  
``` code
            o.uvMain = UnityStereoScreenSpaceUVAdjust(v.texcoord.xy, _MainTex_ST);
```
宏定义中 之类有两个返回，根据上下文这里采用的是返回float2     
``` c++ 
#define UnityStereoScreenSpaceUVAdjust(x, y) UnityStereoScreenSpaceUVAdjustInternal(x, y)

```
``` c++

inline float2 UnityStereoScreenSpaceUVAdjustInternal(float2 uv, float4 scaleAndOffset)
{
    return uv.xy * scaleAndOffset.xy + scaleAndOffset.zw;
}
```
这里是渲染流程后处理阶段， 传入的MainTex 本身应该就是rt   
后续通过设置平面坐标系 完成相应的设置，这里是完成顶点部分uv 设置   
``` c++ 
o.uvMain = UnityStereoScreenSpaceUVAdjust(v.texcoord.xy, _MainTex_ST);
o.uvBase = o.uvMain;

#if UNITY_UV_STARTS_AT_TOP
if (_BaseTex_TexelSize.y < 0.0)
    o.uvBase.y = 1.0 - o.uvBase.y;
#endif
```
### 像素阶段函数   

``` c++ 
        half4 FetchAutoExposed(sampler2D tex, float2 uv)
        {
            float autoExposure = 1.0;
            uv = UnityStereoScreenSpaceUVAdjust(uv, _MainTex_ST);
            autoExposure = tex2D(_AutoExposure, uv).r;
            return tex2D(tex, uv) * autoExposure;
        }
```



















